<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Register | Chattrexx</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");
      * {
        font-family: "Inter", sans-serif;
      }

      body {
        background: linear-gradient(to bottom right, #f8fafc, #e2e8f0);
      }
      body.dark {
        background: linear-gradient(to bottom right, #0f172a, #1e293b);
      }

      .card {
        background: white;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
      }
      .dark .card {
        background: #1e293b;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      }

      .input-field {
        transition: all 0.2s ease;
      }
      .input-field:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .btn-primary {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        transition: all 0.2s ease;
      }
      .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
      }
    </style>

    <script>
      tailwind.config = { darkMode: "class" };
    </script>
  </head>

  <body
    class="flex items-center justify-center min-h-screen p-4 sm:px-6 lg:px-8"
  >
    <!-- Logo in top left corner -->
    <div class="fixed top-4 left-4 sm:top-6 sm:left-6 z-10">
      <div
        class="flex items-center gap-2 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm px-3 py-2 sm:px-4 sm:py-2 rounded-full shadow-lg border border-gray-200 dark:border-gray-700"
      >
        <svg
          class="w-5 h-5 sm:w-6 sm:h-6"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#3b82f6" />
          <path
            d="M2 17L12 22L22 17V12L12 17L2 12V17Z"
            fill="#2563eb"
            opacity="0.7"
          />
        </svg>
        <span
          class="font-semibold text-gray-900 dark:text-white text-xs sm:text-sm"
          >Chattrexx</span
        >
      </div>
    </div>

    <div class="w-11/12 max-w-sm mx-auto">
      <div class="card rounded-2xl border border-gray-200 dark:border-gray-700">
        <div class="p-5 sm:p-7">
          <h2
            class="text-xl sm:text-2xl font-semibold text-gray-900 dark:text-white mb-2"
          >
            Create your account
          </h2>
          <p class="text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-5">
            Join Chattrexx and start chatting
          </p>

          <!-- REGISTER FORM -->
          <form id="registerForm" class="space-y-4">
            <!-- Username -->
            <div>
              <label
                class="block text-xs sm:text-sm mb-1 text-gray-700 dark:text-gray-300"
                >Username</label
              >
              <input
                type="text"
                id="username"
                required
                class="input-field w-full px-3 sm:px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm sm:text-base"
                placeholder="Choose a username"
              />
            </div>

            <!-- Email -->
            <div>
              <label
                class="block text-xs sm:text-sm mb-1 text-gray-700 dark:text-gray-300"
                >Email</label
              >
              <input
                type="email"
                id="email"
                required
                class="input-field w-full px-3 sm:px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm sm:text-base"
                placeholder="Enter your email"
              />
            </div>

            <!-- Password -->
            <div>
              <label
                class="block text-xs sm:text-sm mb-1 text-gray-700 dark:text-gray-300"
                >Password</label
              >
              <input
                type="password"
                id="password"
                required
                class="input-field w-full px-3 sm:px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm sm:text-base"
                placeholder="Create a strong password"
              />
            </div>

            <!-- Confirm Password -->
            <div>
              <label
                class="block text-xs sm:text-sm mb-1 text-gray-700 dark:text-gray-300"
                >Confirm Password</label
              >
              <input
                type="password"
                id="confirmPassword"
                required
                class="input-field w-full px-3 sm:px-4 py-2.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm sm:text-base"
                placeholder="Confirm password"
              />
            </div>

            <!-- Error -->
            <p id="errorMsg" class="text-xs sm:text-sm text-red-500 hidden"></p>

            <!-- Submit -->
            <button
              type="submit"
              class="btn-primary w-full text-white py-2.5 rounded-lg font-medium text-sm sm:text-base"
            >
              Create Account
            </button>
          </form>
        </div>

        <!-- Login link -->
        <div
          class="px-5 sm:px-7 py-4 bg-gray-50 dark:bg-gray-800 text-center rounded-b-2xl border-t border-gray-200 dark:border-gray-700"
        >
          <p class="text-xs sm:text-sm text-gray-600 dark:text-gray-400">
            Already have an account?
            <a
              href="/login.html"
              class="text-blue-600 dark:text-blue-400 font-medium hover:underline"
            >
              Sign in
            </a>
          </p>
        </div>
      </div>
    </div>

    <!-- FIREBASE REGISTER -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
      import {
        getAuth,
        createUserWithEmailAndPassword,
        updateProfile,
      } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
      import {
        getFirestore,
        doc,
        setDoc,
      } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

      // ðŸ”´ PASTE YOUR FIREBASE CONFIG HERE
      const firebaseConfig = {
        apiKey: "AIzaSyDrQdx0vy_hDvb7jO3Z12YXrOFkl1Zl-jw",
        authDomain: "chattrexx.firebaseapp.com",
        projectId: "chattrexx",
        storageBucket: "chattrexx.firebasestorage.app",
        messagingSenderId: "23495067369",
        appId: "1:23495067369:web:8140a94606b45c81d6d278",
        measurementId: "G-5YKSCL74YK",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      const form = document.getElementById("registerForm");
      const errorMsg = document.getElementById("errorMsg");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        errorMsg.classList.add("hidden");

        const username = document.getElementById("username").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value;
        const confirm = document.getElementById("confirmPassword").value;

        if (password !== confirm) {
          errorMsg.textContent = "Passwords do not match";
          errorMsg.classList.remove("hidden");
          return;
        }

        try {
          const userCred = await createUserWithEmailAndPassword(
            auth,
            email,
            password
          );

          await updateProfile(userCred.user, {
            displayName: username,
          });

          await setDoc(doc(db, "users", userCred.user.uid), {
            username,
            email,
            createdAt: new Date(),
          });

          window.location.href = "/chat.html";
        } catch (err) {
          errorMsg.textContent = err.message;
          errorMsg.classList.remove("hidden");
        }
      });
    </script>
  </body>
</html>
